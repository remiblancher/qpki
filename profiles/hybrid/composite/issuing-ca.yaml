# =============================================================================
# Hybrid Composite Issuing CA Certificate Profile (ECDSA P-256 + ML-DSA-65)
# =============================================================================
#
# Usage: Autorité de certification intermédiaire format IETF composite
#
# Issuing CA avec signature composite IETF.
# Les deux signatures (ECDSA et ML-DSA) sont combinées et doivent
# toutes deux valider pour que le certificat soit accepté.
#
# Standards: IETF draft-ounsworth-pq-composite-sigs
#
# Exemple d'initialisation:
#   pki init-ca --profile hybrid/composite/issuing-ca \
#     --cn "ACME Issuing CA Composite" \
#     --org "ACME Industrie" \
#     --country "FR" \
#     --parent /path/to/root-ca-composite
#
# =============================================================================

name: hybrid/composite/issuing-ca
description: "Issuing CA hybrid composite ECDSA P-256 + ML-DSA-65 (IETF format)"

# -----------------------------------------------------------------------------
# Subject DN (Distinguished Name)
# -----------------------------------------------------------------------------
# Pour une Issuing CA composite, le DN est fixé dans le profile.
#
subject:
  fixed:
    c: "FR"
    o: "ACME Industrie"
    cn: "ACME Issuing CA Composite"

# -----------------------------------------------------------------------------
# Algorithmes de signature hybrides
# -----------------------------------------------------------------------------
# Mode composite: signature unique combinant les deux algorithmes.
#
signature:
  mode: composite             # Signature IETF composite (les deux doivent valider)
  algorithms:          # Liste ordonnée: [classical, pqc]
    - ec-p256
    - ml-dsa-65

# -----------------------------------------------------------------------------
# Duree de validite
# -----------------------------------------------------------------------------
validity: 3650d               # 10 ans

# -----------------------------------------------------------------------------
# Extensions X.509
# -----------------------------------------------------------------------------
extensions:

  basicConstraints:
    critical: true
    ca: true
    pathLen: 0                # Ne peut pas signer d'autres CA

  keyUsage:
    critical: true
    values:
      - keyCertSign
      - cRLSign

  certificatePolicies:
    critical: false
    policies:
      - oid: "1.3.6.1.4.1.99999.1.0.5"  # OID politique CA hybrid composite
        cps: "https://pki.acme-industrie.fr/cps"
        userNotice: "ACME Industrie Issuing CA - Hybrid Composite (IETF format)"

  crlDistributionPoints:
    urls:
      - "http://crl.acme-industrie.fr/root-ca-composite.crl"

  authorityInfoAccess:
    caIssuers:
      - "http://pki.acme-industrie.fr/certs/root-ca-composite.crt"

