# =============================================================================
# Hybrid ECDSA+ML-DSA OCSP Responder Certificate Profile (Catalyst)
# =============================================================================
#
# Usage: Hybrid certificate for OCSP responder (RFC 6960 + Catalyst composite)
#
# This certificate uses the Catalyst hybrid approach:
#   - Classical signature: ECDSA P-384 for current compatibility
#   - PQC signature: ML-DSA-65 stored in extension for quantum resistance
#   - Both signatures must verify for the response to be valid
#
# Use cases:
#   - Transition-ready OCSP infrastructure
#   - Organizations requiring both classical and PQC security
#   - High-assurance environments with future-proofing requirements
#
# Standards: RFC 6960 (OCSP), FIPS 204 (ML-DSA), Catalyst hybrid scheme
#
# Example:
#   pki issue --profile hybrid/catalyst/ocsp-responder \
#     --cn "ACME Hybrid OCSP Responder"
#
# =============================================================================

name: hybrid/catalyst/ocsp-responder
description: "OCSP Responder hybrid ECDSA P-384 + ML-DSA-65 (Catalyst)"

# -----------------------------------------------------------------------------
# Subject DN (Distinguished Name)
# -----------------------------------------------------------------------------
subject:
  fixed:
    c: "FR"
    o: "ACME Industrie"
    ou: "PKI Services"
  required:
    - cn
  optional: []

# -----------------------------------------------------------------------------
# Validity Period
# -----------------------------------------------------------------------------
validity: 365d               # 1 year

# -----------------------------------------------------------------------------
# Signature Configuration (Hybrid Catalyst)
# -----------------------------------------------------------------------------
# Hybrid mode with ECDSA classical signature and ML-DSA PQC extension.
#
signature:
  mode: catalyst              # Catalyst hybrid mode (dual signature)
  algorithms:          # Liste ordonn√©e: [classical, pqc]
    - ec-p384
    - ml-dsa-65
  keyUsage:
    - digitalSignature        # Sign OCSP responses

# -----------------------------------------------------------------------------
# X.509 Extensions
# -----------------------------------------------------------------------------
extensions:

  extKeyUsage:
    critical: true
    values:
      - ocspSigning           # OID 1.3.6.1.5.5.7.3.9

  basicConstraints:
    critical: true
    ca: false

  ocspNoCheck:
    critical: false           # Avoid infinite OCSP check loop

  certificatePolicies:
    critical: false
    policies:
      - oid: "1.3.6.1.4.1.99999.1.6.3"  # Hybrid OCSP policy OID
        cps: "https://pki.acme-industrie.fr/cps"
        userNotice: "Certificat OCSP Responder hybride emis par ACME PKI"

  crlDistributionPoints:
    urls:
      - "http://crl.acme-industrie.fr/issuing-ca.crl"

  authorityInfoAccess:
    caIssuers:
      - "http://pki.acme-industrie.fr/certs/issuing-ca.crt"
