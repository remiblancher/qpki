# =============================================================================
# SLH-DSA Root CA Certificate Profile (SLH-DSA-256f)
# =============================================================================
#
# Usage: Autorité de certification racine hash-based
#
# Ce profile utilise SLH-DSA-256f (FIPS 205) pour une Root CA avec
# le niveau de sécurité maximal basé sur les fonctions de hachage.
#
# SLH-DSA-256f offre:
#   - Sécurité équivalente à AES-256 (niveau NIST 5)
#   - Résistance quantique basée uniquement sur SHA-256
#   - Aucune hypothèse sur la difficulté des problèmes de lattices
#
# Ce choix est approprié pour les organisations qui préfèrent
# une approche ultra-conservative, même avec des signatures de ~49 KB.
#
# Standards: FIPS 205 (SLH-DSA), RFC 5280 (X.509)
#
# Exemple d'initialisation:
#   pki init-ca --profile slh-dsa/root-ca \
#     --cn "ACME Root CA SLH-DSA" \
#     --org "ACME Industrie" \
#     --country "FR"
#
# =============================================================================

name: slh-dsa/root-ca
description: "Root CA SLH-DSA-256f (hash-based, NIST security level 5)"

# -----------------------------------------------------------------------------
# Subject DN (Distinguished Name)
# -----------------------------------------------------------------------------
# Pour une Root CA, le DN est fixé dans le profile.
#
subject:
  fixed:
    cn: "ACME Root CA SLH-DSA"
    o: "ACME Industrie"
    c: "FR"

# -----------------------------------------------------------------------------
# Algorithme de signature
# -----------------------------------------------------------------------------
# SLH-DSA-256f pour sécurité maximale sur 20 ans.
# Signatures grandes (~49 KB) mais sécurité incontestable.
#
signature:
  required: true
  mode: simple
  algorithms:
    primary: slh-dsa-256f     # FIPS 205 - niveau de sécurité 5

encryption:
  required: false
  mode: none
  algorithms: {}

validity: 7300d               # 20 ans

# -----------------------------------------------------------------------------
# Extensions X.509
# -----------------------------------------------------------------------------
extensions:

  basicConstraints:
    critical: true
    ca: true
    pathLen: 1

  keyUsage:
    critical: true
    values:
      - keyCertSign
      - cRLSign

  certificatePolicies:
    critical: false
    policies:
      - oid: "2.5.29.32.0"    # anyPolicy
        cps: "https://pki.acme-industrie.fr/cps"
        userNotice: "ACME Industrie Root CA - Hash-Based Post-Quantum (SLH-DSA-256f)"

