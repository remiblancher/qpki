# =============================================================================
# ML-DSA OCSP Responder Certificate Profile (Post-Quantum)
# =============================================================================
#
# Usage: Certificate for OCSP responder with post-quantum signature (RFC 6960)
#
# This certificate allows an OCSP responder to:
#   - Sign OCSP responses using ML-DSA-65 (FIPS 204)
#   - Provide quantum-resistant certificate status verification
#   - Future-proof revocation status infrastructure
#
# Use cases:
#   - Post-quantum OCSP responder
#   - Quantum-resistant PKI infrastructure
#   - High-security environments
#
# Standards: RFC 6960 (OCSP), FIPS 204 (ML-DSA)
#
# Example:
#   pki issue --profile ml-dsa-kem/ocsp-responder \
#     --cn "ACME PQC OCSP Responder"
#
# =============================================================================

name: ml-dsa-kem/ocsp-responder
description: "OCSP Responder certificate ML-DSA-65 (RFC 6960, FIPS 204)"

# -----------------------------------------------------------------------------
# Subject DN (Distinguished Name)
# -----------------------------------------------------------------------------
subject:
  fixed:
    c: "FR"
    o: "ACME Industrie"
    ou: "PKI Services"
  required:
    - cn
  optional: []

# -----------------------------------------------------------------------------
# Validity Period
# -----------------------------------------------------------------------------
validity: 365d               # 1 year

# -----------------------------------------------------------------------------
# Signature Key
# -----------------------------------------------------------------------------
# ML-DSA-65 provides 128-bit post-quantum security level.
#
signature:
  algorithms:        # ML-DSA-65 (FIPS 204)
    - ml-dsa-65
  keyUsage:
    - digitalSignature        # Sign OCSP responses

# -----------------------------------------------------------------------------
# X.509 Extensions
# -----------------------------------------------------------------------------
extensions:

  extKeyUsage:
    critical: true
    values:
      - ocspSigning           # OID 1.3.6.1.5.5.7.3.9

  basicConstraints:
    critical: true
    ca: false

  ocspNoCheck:
    critical: false           # Avoid infinite OCSP check loop

  certificatePolicies:
    critical: false
    policies:
      - oid: "1.3.6.1.4.1.99999.1.6.2"  # PQC OCSP policy OID
        cps: "https://pki.acme-industrie.fr/cps"
        userNotice: "Certificat OCSP Responder post-quantique emis par ACME PKI"

  crlDistributionPoints:
    urls:
      - "http://crl.acme-industrie.fr/issuing-ca.crl"

  authorityInfoAccess:
    caIssuers:
      - "http://pki.acme-industrie.fr/certs/issuing-ca.crt"
