# =============================================================================
# ML-DSA Root CA Certificate Profile (Pure Post-Quantum)
# =============================================================================
#
# Usage: Root CA (trust anchor) with full quantum resistance
#
# This certificate provides:
#   - Complete protection against quantum computer attacks
#   - No reliance on classical cryptography
#   - Highest NIST security level (Level 5)
#
# Standards: FIPS 204 (ML-DSA), RFC 5280 (X.509)
#
# Security Level: NIST Level 5 (~256-bit equivalent)
#   ML-DSA-87 is the strongest ML-DSA variant.
#   Equivalent security to AES-256 against quantum attacks.
#
# Quantum Safety: FULLY PROTECTED
#   Pure PQC - no classical algorithms involved.
#   Safe against both classical and quantum computers.
#
# Compatibility Warning:
#   Pure PQC certificates are NOT compatible with existing PKI software.
#   Most applications cannot verify ML-DSA signatures yet.
#   For backward compatibility, use hybrid/catalyst/ profiles instead.
#
# Use Cases:
#   - Future-proof PKI infrastructure
#   - Internal systems with PQC-capable software
#   - Research and testing environments
#
# Example:
#   pki init-ca --profile ml-dsa-kem/root-ca \
#     --name "ACME Root CA PQC" --dir ./root-ca-pqc
#
# Expected DN: CN=ACME Root CA PQC, O=ACME Corp, C=US
#
# =============================================================================

name: ml-dsa-kem/root-ca
description: "Root CA ML-DSA-87 (full post-quantum, NIST security level 5)"

# -----------------------------------------------------------------------------
# Algorithm
# -----------------------------------------------------------------------------
# ML-DSA-87 (FIPS 204) - Module-Lattice Digital Signature Algorithm
#   - NIST Level 5 security (~256-bit equivalent)
#   - Strongest variant for maximum Root CA protection
#   - Public key: ~2528 bytes, Signature: ~4627 bytes
#
algorithm: ml-dsa-87

# -----------------------------------------------------------------------------
# Validity
# -----------------------------------------------------------------------------
# 20 years for Root CA.
#
validity: 7300d

# -----------------------------------------------------------------------------
# Subject DN (Distinguished Name)
# -----------------------------------------------------------------------------
subject:
  fixed:
    c: "US"
    o: "ACME Corp"
    cn: "ACME Root CA PQC"

# -----------------------------------------------------------------------------
# X.509 Extensions
# -----------------------------------------------------------------------------
extensions:

  # Basic Constraints (RFC 5280 Section 4.2.1.9)
  # ---------------------------------------------------------------------------
  basicConstraints:
    critical: true
    ca: true
    pathLen: 1

  # Key Usage (RFC 5280 Section 4.2.1.3)
  # ---------------------------------------------------------------------------
  keyUsage:
    critical: true
    values:
      - keyCertSign
      - cRLSign

  # Certificate Policies (RFC 5280 Section 4.2.1.4)
  # ---------------------------------------------------------------------------
  certificatePolicies:
    critical: false
    policies:
      - oid: "2.5.29.32.0"
        cps: "https://pki.acme.example.com/cps"
        userNotice: "ACME Corp Root CA - Post-Quantum (ML-DSA-87)"
